SELECT u.utilizador_id AS aluno_id, u.utilizador_nome AS aluno, c.curso_id AS curso_id, c.curso_desc AS curso, a.avaliacao_nota AS nota
FROM q_avaliacoes a
JOIN q_utilizadores u ON a.avaliacao_aluno_id = u.utilizador_id
JOIN q_cursos c ON a.avaliacao_curso = c.curso_id;


SELECT DISTINCT u.utilizador_id, u.utilizador_nome, c.curso_desc, c.curso_id 
        FROM q_avaliacoes a 
        JOIN q_utilizadores u ON a.avaliacao_aluno_id = u.utilizador_id 
        JOIN q_cursos c ON a.avaliacao_curso = c.curso_id 
        GROUP BY c.curso_id, u.utilizador_id, c.curso_desc, u.utilizador_nome ORDER BY u.utilizador_nome


SELECT subquery.utilizador_id, subquery.utilizador_nome, subquery.curso_desc, subquery.curso_id
FROM (
    SELECT u.utilizador_id, u.utilizador_nome, c.curso_desc, c.curso_id,
        ROW_NUMBER() OVER(PARTITION BY u.utilizador_id, c.curso_id ORDER BY u.utilizador_nome) AS row_num
    FROM q_avaliacoes a
    JOIN q_utilizadores u ON a.avaliacao_aluno_id = u.utilizador_id
    JOIN q_cursos c ON a.avaliacao_curso = c.curso_id
) subquery
WHERE subquery.row_num = 1
ORDER BY subquery.utilizador_nome;



SELECT u.utilizador_id, u.utilizador_nome, c.curso_desc, c.curso_id 
        FROM q_utilizadores u 
        JOIN q_alunos_cursos ac ON u.utilizador_id = ac.aluno_id 
        JOIN q_cursos c ON ac.curso_id = c.curso_id 
        ORDER BY u.utilizador_nome;


SELECT DISTINCT u.utilizador_id AS aluno_id, u.utilizador_nome AS aluno, c.curso_desc AS curso, c.curso_id FROM q_avaliacoes a JOIN q_utilizadores u ON a.avaliacao_aluno_id = u.utilizador_id JOIN q_cursos c ON a.avaliacao_curso = c.curso_id GROUP BY u.utilizador_id, u.utilizador_nome, c.curso_desc, c.curso_id ORDER BY u.utilizador_nome;



SELECT u.utilizador_id AS aluno_id, u.utilizador_nome AS aluno, c.curso_desc AS curso, c.curso_id, COUNT(*) AS num_avaliacoes
FROM q_avaliacoes a
JOIN q_utilizadores u ON a.avaliacao_aluno_id = u.utilizador_id
JOIN q_cursos c ON a.avaliacao_curso = c.curso_id
GROUP BY u.utilizador_id, u.utilizador_nome, c.curso_desc, c.curso_id
HAVING COUNT(*) >= 2
ORDER BY u.utilizador_nome;

